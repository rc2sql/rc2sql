%
\begin{isabellebody}%
\setisabellecontext{Cluster}%
%
\isadelimtheory
%
\endisadelimtheory
%
\isatagtheory
\isacommand{theory}\isamarkupfalse%
\ Cluster\isanewline
\ \ \isakeyword{imports}\ Mapping{\isacharunderscore}{\kern0pt}Code\isanewline
\isakeyword{begin}%
\endisatagtheory
{\isafoldtheory}%
%
\isadelimtheory
\isanewline
%
\endisadelimtheory
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ these{\isacharunderscore}{\kern0pt}Un{\isacharbrackleft}{\kern0pt}simp{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}Option{\isachardot}{\kern0pt}these\ {\isacharparenleft}{\kern0pt}A\ {\isasymunion}\ B{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ Option{\isachardot}{\kern0pt}these\ A\ {\isasymunion}\ Option{\isachardot}{\kern0pt}these\ B{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp{\isacharcolon}{\kern0pt}\ Option{\isachardot}{\kern0pt}these{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ these{\isacharunderscore}{\kern0pt}insert{\isacharbrackleft}{\kern0pt}simp{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}Option{\isachardot}{\kern0pt}these\ {\isacharparenleft}{\kern0pt}insert\ x\ A{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}case\ x\ of\ Some\ a\ {\isasymRightarrow}\ insert\ a\ {\isacharbar}{\kern0pt}\ None\ {\isasymRightarrow}\ id{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}Option{\isachardot}{\kern0pt}these\ A{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp{\isacharcolon}{\kern0pt}\ Option{\isachardot}{\kern0pt}these{\isacharunderscore}{\kern0pt}def\ split{\isacharcolon}{\kern0pt}\ option{\isachardot}{\kern0pt}splits{\isacharparenright}{\kern0pt}\ force%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ these{\isacharunderscore}{\kern0pt}image{\isacharunderscore}{\kern0pt}Un{\isacharbrackleft}{\kern0pt}simp{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}Option{\isachardot}{\kern0pt}these\ {\isacharparenleft}{\kern0pt}f\ {\isacharbackquote}{\kern0pt}\ {\isacharparenleft}{\kern0pt}A\ {\isasymunion}\ B{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ Option{\isachardot}{\kern0pt}these\ {\isacharparenleft}{\kern0pt}f\ {\isacharbackquote}{\kern0pt}\ A{\isacharparenright}{\kern0pt}\ {\isasymunion}\ Option{\isachardot}{\kern0pt}these\ {\isacharparenleft}{\kern0pt}f\ {\isacharbackquote}{\kern0pt}\ B{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp{\isacharcolon}{\kern0pt}\ Option{\isachardot}{\kern0pt}these{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ these{\isacharunderscore}{\kern0pt}imageI{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}f\ x\ {\isacharequal}{\kern0pt}\ Some\ y\ {\isasymLongrightarrow}\ x\ {\isasymin}\ X\ {\isasymLongrightarrow}\ y\ {\isasymin}\ Option{\isachardot}{\kern0pt}these\ {\isacharparenleft}{\kern0pt}f\ {\isacharbackquote}{\kern0pt}\ X{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}force\ simp{\isacharcolon}{\kern0pt}\ Option{\isachardot}{\kern0pt}these{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lift{\isacharunderscore}{\kern0pt}definition}\isamarkupfalse%
\ cluster\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isacharprime}{\kern0pt}b\ {\isasymRightarrow}\ {\isacharprime}{\kern0pt}a\ option{\isacharparenright}{\kern0pt}\ {\isasymRightarrow}\ {\isacharprime}{\kern0pt}b\ set\ {\isasymRightarrow}\ {\isacharparenleft}{\kern0pt}{\isacharprime}{\kern0pt}a{\isacharcomma}{\kern0pt}\ {\isacharprime}{\kern0pt}b\ set{\isacharparenright}{\kern0pt}\ mapping{\isachardoublequoteclose}\ \isakeyword{is}\isanewline
\ \ {\isachardoublequoteopen}{\isasymlambda}f\ Y\ x{\isachardot}{\kern0pt}\ if\ Some\ x\ {\isasymin}\ f\ {\isacharbackquote}{\kern0pt}\ Y\ then\ Some\ {\isacharbraceleft}{\kern0pt}y\ {\isasymin}\ Y{\isachardot}{\kern0pt}\ f\ y\ {\isacharequal}{\kern0pt}\ Some\ x{\isacharbraceright}{\kern0pt}\ else\ None{\isachardoublequoteclose}%
\isadelimproof
\ %
\endisadelimproof
%
\isatagproof
\isacommand{{\isachardot}{\kern0pt}}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ set{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}idx{\isacharunderscore}{\kern0pt}cluster{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}set{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}idx\ {\isacharparenleft}{\kern0pt}cluster\ {\isacharparenleft}{\kern0pt}Some\ {\isasymcirc}\ f{\isacharparenright}{\kern0pt}\ X{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ X{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ transfer\ {\isacharparenleft}{\kern0pt}auto\ simp{\isacharcolon}{\kern0pt}\ ran{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ lookup{\isacharunderscore}{\kern0pt}cluster{\isacharprime}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}Mapping{\isachardot}{\kern0pt}lookup\ {\isacharparenleft}{\kern0pt}cluster\ {\isacharparenleft}{\kern0pt}Some\ {\isasymcirc}\ h{\isacharparenright}{\kern0pt}\ X{\isacharparenright}{\kern0pt}\ y\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}if\ y\ {\isasymnotin}\ h\ {\isacharbackquote}{\kern0pt}\ X\ then\ None\ else\ Some\ {\isacharbraceleft}{\kern0pt}x\ {\isasymin}\ X{\isachardot}{\kern0pt}\ h\ x\ {\isacharequal}{\kern0pt}\ y{\isacharbraceright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ transfer\ auto%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{context}\isamarkupfalse%
\ ord\isanewline
\isakeyword{begin}\isanewline
\isanewline
\isacommand{definition}\isamarkupfalse%
\ add{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}rbt\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharprime}{\kern0pt}a\ {\isasymtimes}\ {\isacharprime}{\kern0pt}b\ {\isasymRightarrow}\ {\isacharparenleft}{\kern0pt}{\isacharprime}{\kern0pt}a{\isacharcomma}{\kern0pt}\ {\isacharprime}{\kern0pt}b\ set{\isacharparenright}{\kern0pt}\ rbt\ {\isasymRightarrow}\ {\isacharparenleft}{\kern0pt}{\isacharprime}{\kern0pt}a{\isacharcomma}{\kern0pt}\ {\isacharprime}{\kern0pt}b\ set{\isacharparenright}{\kern0pt}\ rbt{\isachardoublequoteclose}\ \isakeyword{where}\isanewline
\ \ {\isachardoublequoteopen}add{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}rbt\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}{\isacharparenleft}{\kern0pt}a{\isacharcomma}{\kern0pt}\ b{\isacharparenright}{\kern0pt}\ t{\isachardot}{\kern0pt}\ case\ rbt{\isacharunderscore}{\kern0pt}lookup\ t\ a\ of\ Some\ X\ {\isasymRightarrow}\ rbt{\isacharunderscore}{\kern0pt}insert\ a\ {\isacharparenleft}{\kern0pt}insert\ b\ X{\isacharparenright}{\kern0pt}\ t\ {\isacharbar}{\kern0pt}\ None\ {\isasymRightarrow}\ rbt{\isacharunderscore}{\kern0pt}insert\ a\ {\isacharbraceleft}{\kern0pt}b{\isacharbraceright}{\kern0pt}\ t{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{abbreviation}\isamarkupfalse%
\ {\isachardoublequoteopen}add{\isacharunderscore}{\kern0pt}option{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}rbt\ f\ {\isasymequiv}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}b\ {\isacharunderscore}{\kern0pt}\ t{\isachardot}{\kern0pt}\ case\ f\ b\ of\ Some\ a\ {\isasymRightarrow}\ add{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}rbt\ {\isacharparenleft}{\kern0pt}a{\isacharcomma}{\kern0pt}\ b{\isacharparenright}{\kern0pt}\ t\ {\isacharbar}{\kern0pt}\ None\ {\isasymRightarrow}\ t{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{definition}\isamarkupfalse%
\ cluster{\isacharunderscore}{\kern0pt}rbt\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isacharprime}{\kern0pt}b\ {\isasymRightarrow}\ {\isacharprime}{\kern0pt}a\ option{\isacharparenright}{\kern0pt}\ {\isasymRightarrow}\ {\isacharparenleft}{\kern0pt}{\isacharprime}{\kern0pt}b{\isacharcomma}{\kern0pt}\ unit{\isacharparenright}{\kern0pt}\ rbt\ {\isasymRightarrow}\ {\isacharparenleft}{\kern0pt}{\isacharprime}{\kern0pt}a{\isacharcomma}{\kern0pt}\ {\isacharprime}{\kern0pt}b\ set{\isacharparenright}{\kern0pt}\ rbt{\isachardoublequoteclose}\ \isakeyword{where}\isanewline
\ \ {\isachardoublequoteopen}cluster{\isacharunderscore}{\kern0pt}rbt\ f\ t\ {\isacharequal}{\kern0pt}\ RBT{\isacharunderscore}{\kern0pt}Impl{\isachardot}{\kern0pt}fold\ {\isacharparenleft}{\kern0pt}add{\isacharunderscore}{\kern0pt}option{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}rbt\ f{\isacharparenright}{\kern0pt}\ t\ RBT{\isacharunderscore}{\kern0pt}Impl{\isachardot}{\kern0pt}Empty{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{end}\isamarkupfalse%
\isanewline
\isanewline
\isacommand{context}\isamarkupfalse%
\ linorder\isanewline
\isakeyword{begin}\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ is{\isacharunderscore}{\kern0pt}rbt{\isacharunderscore}{\kern0pt}add{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}rbt{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}is{\isacharunderscore}{\kern0pt}rbt\ t\ {\isasymLongrightarrow}\ is{\isacharunderscore}{\kern0pt}rbt\ {\isacharparenleft}{\kern0pt}add{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}rbt\ ab\ t{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp{\isacharcolon}{\kern0pt}\ add{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}rbt{\isacharunderscore}{\kern0pt}def\ split{\isacharcolon}{\kern0pt}\ prod{\isachardot}{\kern0pt}splits\ option{\isachardot}{\kern0pt}splits{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ is{\isacharunderscore}{\kern0pt}rbt{\isacharunderscore}{\kern0pt}fold{\isacharunderscore}{\kern0pt}add{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}rbt{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}is{\isacharunderscore}{\kern0pt}rbt\ t{\isacharprime}{\kern0pt}\ {\isasymLongrightarrow}\isanewline
\ \ is{\isacharunderscore}{\kern0pt}rbt\ {\isacharparenleft}{\kern0pt}RBT{\isacharunderscore}{\kern0pt}Impl{\isachardot}{\kern0pt}fold\ {\isacharparenleft}{\kern0pt}add{\isacharunderscore}{\kern0pt}option{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}rbt\ f{\isacharparenright}{\kern0pt}\ t\ t{\isacharprime}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}induction\ t\ arbitrary{\isacharcolon}{\kern0pt}\ t{\isacharprime}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}auto\ {\isadigit{0}}\ {\isadigit{0}}\ simp{\isacharcolon}{\kern0pt}\ is{\isacharunderscore}{\kern0pt}rbt{\isacharunderscore}{\kern0pt}add{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}rbt\ split{\isacharcolon}{\kern0pt}\ option{\isachardot}{\kern0pt}splits{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ is{\isacharunderscore}{\kern0pt}rbt{\isacharunderscore}{\kern0pt}cluster{\isacharunderscore}{\kern0pt}rbt{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}is{\isacharunderscore}{\kern0pt}rbt\ {\isacharparenleft}{\kern0pt}cluster{\isacharunderscore}{\kern0pt}rbt\ f\ t{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ is{\isacharunderscore}{\kern0pt}rbt{\isacharunderscore}{\kern0pt}fold{\isacharunderscore}{\kern0pt}add{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}rbt\ Empty{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}rbt\isanewline
\ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}fastforce\ simp{\isacharcolon}{\kern0pt}\ cluster{\isacharunderscore}{\kern0pt}rbt{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ rbt{\isacharunderscore}{\kern0pt}insert{\isacharunderscore}{\kern0pt}entries{\isacharunderscore}{\kern0pt}None{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}is{\isacharunderscore}{\kern0pt}rbt\ t\ {\isasymLongrightarrow}\ rbt{\isacharunderscore}{\kern0pt}lookup\ t\ k\ {\isacharequal}{\kern0pt}\ None\ {\isasymLongrightarrow}\isanewline
\ \ set\ {\isacharparenleft}{\kern0pt}RBT{\isacharunderscore}{\kern0pt}Impl{\isachardot}{\kern0pt}entries\ {\isacharparenleft}{\kern0pt}rbt{\isacharunderscore}{\kern0pt}insert\ k\ v\ t{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ insert\ {\isacharparenleft}{\kern0pt}k{\isacharcomma}{\kern0pt}\ v{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}set\ {\isacharparenleft}{\kern0pt}RBT{\isacharunderscore}{\kern0pt}Impl{\isachardot}{\kern0pt}entries\ t{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp{\isacharcolon}{\kern0pt}\ rbt{\isacharunderscore}{\kern0pt}lookup{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}tree{\isacharbrackleft}{\kern0pt}symmetric{\isacharbrackright}{\kern0pt}\ rbt{\isacharunderscore}{\kern0pt}lookup{\isacharunderscore}{\kern0pt}rbt{\isacharunderscore}{\kern0pt}insert\ split{\isacharcolon}{\kern0pt}\ if{\isacharunderscore}{\kern0pt}splits{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ rbt{\isacharunderscore}{\kern0pt}insert{\isacharunderscore}{\kern0pt}entries{\isacharunderscore}{\kern0pt}Some{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}is{\isacharunderscore}{\kern0pt}rbt\ t\ {\isasymLongrightarrow}\ rbt{\isacharunderscore}{\kern0pt}lookup\ t\ k\ {\isacharequal}{\kern0pt}\ Some\ v{\isacharprime}{\kern0pt}\ {\isasymLongrightarrow}\isanewline
\ \ set\ {\isacharparenleft}{\kern0pt}RBT{\isacharunderscore}{\kern0pt}Impl{\isachardot}{\kern0pt}entries\ {\isacharparenleft}{\kern0pt}rbt{\isacharunderscore}{\kern0pt}insert\ k\ v\ t{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ insert\ {\isacharparenleft}{\kern0pt}k{\isacharcomma}{\kern0pt}\ v{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}set\ {\isacharparenleft}{\kern0pt}RBT{\isacharunderscore}{\kern0pt}Impl{\isachardot}{\kern0pt}entries\ t{\isacharparenright}{\kern0pt}\ {\isacharminus}{\kern0pt}\ {\isacharbraceleft}{\kern0pt}{\isacharparenleft}{\kern0pt}k{\isacharcomma}{\kern0pt}\ v{\isacharprime}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharbraceright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp{\isacharcolon}{\kern0pt}\ rbt{\isacharunderscore}{\kern0pt}lookup{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}tree{\isacharbrackleft}{\kern0pt}symmetric{\isacharbrackright}{\kern0pt}\ rbt{\isacharunderscore}{\kern0pt}lookup{\isacharunderscore}{\kern0pt}rbt{\isacharunderscore}{\kern0pt}insert\ split{\isacharcolon}{\kern0pt}\ if{\isacharunderscore}{\kern0pt}splits{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ keys{\isacharunderscore}{\kern0pt}add{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}rbt{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}is{\isacharunderscore}{\kern0pt}rbt\ t\ {\isasymLongrightarrow}\ set\ {\isacharparenleft}{\kern0pt}RBT{\isacharunderscore}{\kern0pt}Impl{\isachardot}{\kern0pt}keys\ {\isacharparenleft}{\kern0pt}add{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}rbt\ {\isacharparenleft}{\kern0pt}a{\isacharcomma}{\kern0pt}\ b{\isacharparenright}{\kern0pt}\ t{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ insert\ a\ {\isacharparenleft}{\kern0pt}set\ {\isacharparenleft}{\kern0pt}RBT{\isacharunderscore}{\kern0pt}Impl{\isachardot}{\kern0pt}keys\ t{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp{\isacharcolon}{\kern0pt}\ add{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}rbt{\isacharunderscore}{\kern0pt}def\ RBT{\isacharunderscore}{\kern0pt}Impl{\isachardot}{\kern0pt}keys{\isacharunderscore}{\kern0pt}def\ rbt{\isacharunderscore}{\kern0pt}insert{\isacharunderscore}{\kern0pt}entries{\isacharunderscore}{\kern0pt}None\ rbt{\isacharunderscore}{\kern0pt}insert{\isacharunderscore}{\kern0pt}entries{\isacharunderscore}{\kern0pt}Some\ split{\isacharcolon}{\kern0pt}\ option{\isachardot}{\kern0pt}splits{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ keys{\isacharunderscore}{\kern0pt}fold{\isacharunderscore}{\kern0pt}add{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}rbt{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}is{\isacharunderscore}{\kern0pt}rbt\ t{\isacharprime}{\kern0pt}\ {\isasymLongrightarrow}\ set\ {\isacharparenleft}{\kern0pt}RBT{\isacharunderscore}{\kern0pt}Impl{\isachardot}{\kern0pt}keys\ {\isacharparenleft}{\kern0pt}RBT{\isacharunderscore}{\kern0pt}Impl{\isachardot}{\kern0pt}fold\ {\isacharparenleft}{\kern0pt}add{\isacharunderscore}{\kern0pt}option{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}rbt\ f{\isacharparenright}{\kern0pt}\ t\ t{\isacharprime}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\isanewline
\ \ Option{\isachardot}{\kern0pt}these\ {\isacharparenleft}{\kern0pt}f\ {\isacharbackquote}{\kern0pt}\ set\ {\isacharparenleft}{\kern0pt}RBT{\isacharunderscore}{\kern0pt}Impl{\isachardot}{\kern0pt}keys\ t{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymunion}\ set\ {\isacharparenleft}{\kern0pt}RBT{\isacharunderscore}{\kern0pt}Impl{\isachardot}{\kern0pt}keys\ t{\isacharprime}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}induction\ t\ arbitrary{\isacharcolon}{\kern0pt}\ t{\isacharprime}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{case}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}Branch\ col\ t{\isadigit{1}}\ k\ v\ t{\isadigit{2}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ valid{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}is{\isacharunderscore}{\kern0pt}rbt\ {\isacharparenleft}{\kern0pt}RBT{\isacharunderscore}{\kern0pt}Impl{\isachardot}{\kern0pt}fold\ {\isacharparenleft}{\kern0pt}add{\isacharunderscore}{\kern0pt}option{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}rbt\ f{\isacharparenright}{\kern0pt}\ t{\isadigit{1}}\ t{\isacharprime}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ Branch{\isacharparenleft}{\kern0pt}{\isadigit{3}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ intro{\isacharcolon}{\kern0pt}\ is{\isacharunderscore}{\kern0pt}rbt{\isacharunderscore}{\kern0pt}fold{\isacharunderscore}{\kern0pt}add{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}rbt{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}case\isanewline
\ \ \isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}cases\ {\isachardoublequoteopen}f\ k{\isachardoublequoteclose}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{case}\isamarkupfalse%
\ None\isanewline
\ \ \ \ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp{\isacharcolon}{\kern0pt}\ None\ Branch{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}{\isacharbrackleft}{\kern0pt}OF\ valid{\isacharbrackright}{\kern0pt}\ Branch{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharbrackleft}{\kern0pt}OF\ Branch{\isacharparenleft}{\kern0pt}{\isadigit{3}}{\isacharparenright}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{next}\isamarkupfalse%
\isanewline
\ \ \ \ \isacommand{case}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}Some\ a{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{have}\isamarkupfalse%
\ valid{\isacharprime}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}is{\isacharunderscore}{\kern0pt}rbt\ {\isacharparenleft}{\kern0pt}add{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}rbt\ {\isacharparenleft}{\kern0pt}a{\isacharcomma}{\kern0pt}\ k{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}RBT{\isacharunderscore}{\kern0pt}Impl{\isachardot}{\kern0pt}fold\ {\isacharparenleft}{\kern0pt}add{\isacharunderscore}{\kern0pt}option{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}rbt\ f{\isacharparenright}{\kern0pt}\ t{\isadigit{1}}\ t{\isacharprime}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ intro{\isacharcolon}{\kern0pt}\ is{\isacharunderscore}{\kern0pt}rbt{\isacharunderscore}{\kern0pt}add{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}rbt{\isacharbrackleft}{\kern0pt}OF\ valid{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp{\isacharcolon}{\kern0pt}\ Some\ Branch{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}{\isacharbrackleft}{\kern0pt}OF\ valid{\isacharprime}{\kern0pt}{\isacharbrackright}{\kern0pt}\ keys{\isacharunderscore}{\kern0pt}add{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}rbt{\isacharbrackleft}{\kern0pt}OF\ valid{\isacharbrackright}{\kern0pt}\ Branch{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharbrackleft}{\kern0pt}OF\ Branch{\isacharparenleft}{\kern0pt}{\isadigit{3}}{\isacharparenright}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\isacommand{qed}\isamarkupfalse%
\ auto%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ rbt{\isacharunderscore}{\kern0pt}lookup{\isacharunderscore}{\kern0pt}add{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}rbt{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}is{\isacharunderscore}{\kern0pt}rbt\ t\ {\isasymLongrightarrow}\ rbt{\isacharunderscore}{\kern0pt}lookup\ {\isacharparenleft}{\kern0pt}add{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}rbt\ {\isacharparenleft}{\kern0pt}a{\isacharcomma}{\kern0pt}\ b{\isacharparenright}{\kern0pt}\ t{\isacharparenright}{\kern0pt}\ x\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}if\ a\ {\isacharequal}{\kern0pt}\ x\ then\ Some\ {\isacharparenleft}{\kern0pt}case\ rbt{\isacharunderscore}{\kern0pt}lookup\ t\ x\ of\ None\ {\isasymRightarrow}\ {\isacharbraceleft}{\kern0pt}b{\isacharbraceright}{\kern0pt}\ {\isacharbar}{\kern0pt}\ Some\ Y\ {\isasymRightarrow}\ insert\ b\ Y{\isacharparenright}{\kern0pt}\ else\ rbt{\isacharunderscore}{\kern0pt}lookup\ t\ x{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp{\isacharcolon}{\kern0pt}\ add{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}rbt{\isacharunderscore}{\kern0pt}def\ rbt{\isacharunderscore}{\kern0pt}lookup{\isacharunderscore}{\kern0pt}rbt{\isacharunderscore}{\kern0pt}insert\ split{\isacharcolon}{\kern0pt}\ option{\isachardot}{\kern0pt}splits{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ rbt{\isacharunderscore}{\kern0pt}lookup{\isacharunderscore}{\kern0pt}fold{\isacharunderscore}{\kern0pt}add{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}rbt{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}is{\isacharunderscore}{\kern0pt}rbt\ t{\isacharprime}{\kern0pt}\ {\isasymLongrightarrow}\ rbt{\isacharunderscore}{\kern0pt}lookup\ {\isacharparenleft}{\kern0pt}RBT{\isacharunderscore}{\kern0pt}Impl{\isachardot}{\kern0pt}fold\ {\isacharparenleft}{\kern0pt}add{\isacharunderscore}{\kern0pt}option{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}rbt\ f{\isacharparenright}{\kern0pt}\ t\ t{\isacharprime}{\kern0pt}{\isacharparenright}{\kern0pt}\ x\ {\isacharequal}{\kern0pt}\isanewline
\ \ \ \ {\isacharparenleft}{\kern0pt}if\ x\ {\isasymin}\ Option{\isachardot}{\kern0pt}these\ {\isacharparenleft}{\kern0pt}f\ {\isacharbackquote}{\kern0pt}\ set\ {\isacharparenleft}{\kern0pt}RBT{\isacharunderscore}{\kern0pt}Impl{\isachardot}{\kern0pt}keys\ t{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymunion}\ set\ {\isacharparenleft}{\kern0pt}RBT{\isacharunderscore}{\kern0pt}Impl{\isachardot}{\kern0pt}keys\ t{\isacharprime}{\kern0pt}{\isacharparenright}{\kern0pt}\ then\ Some\ {\isacharparenleft}{\kern0pt}{\isacharbraceleft}{\kern0pt}y\ {\isasymin}\ set\ {\isacharparenleft}{\kern0pt}RBT{\isacharunderscore}{\kern0pt}Impl{\isachardot}{\kern0pt}keys\ t{\isacharparenright}{\kern0pt}{\isachardot}{\kern0pt}\ f\ y\ {\isacharequal}{\kern0pt}\ Some\ x{\isacharbraceright}{\kern0pt}\isanewline
\ \ \ \ {\isasymunion}\ {\isacharparenleft}{\kern0pt}case\ rbt{\isacharunderscore}{\kern0pt}lookup\ t{\isacharprime}{\kern0pt}\ x\ of\ None\ {\isasymRightarrow}\ {\isacharbraceleft}{\kern0pt}{\isacharbraceright}{\kern0pt}\ {\isacharbar}{\kern0pt}\ Some\ Y\ {\isasymRightarrow}\ Y{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ else\ None{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}induction\ t\ arbitrary{\isacharcolon}{\kern0pt}\ t{\isacharprime}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{case}\isamarkupfalse%
\ Empty\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}case\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ rbt{\isacharunderscore}{\kern0pt}lookup{\isacharunderscore}{\kern0pt}iff{\isacharunderscore}{\kern0pt}keys{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharcomma}{\kern0pt}{\isadigit{3}}{\isacharparenright}{\kern0pt}{\isacharbrackleft}{\kern0pt}OF\ is{\isacharunderscore}{\kern0pt}rbt{\isacharunderscore}{\kern0pt}rbt{\isacharunderscore}{\kern0pt}sorted{\isacharbrackright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}fastforce\ split{\isacharcolon}{\kern0pt}\ option{\isachardot}{\kern0pt}splits{\isacharparenright}{\kern0pt}\isanewline
\isacommand{next}\isamarkupfalse%
\isanewline
\ \ \isacommand{case}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}Branch\ col\ t{\isadigit{1}}\ k\ v\ t{\isadigit{2}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ valid{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}is{\isacharunderscore}{\kern0pt}rbt\ {\isacharparenleft}{\kern0pt}RBT{\isacharunderscore}{\kern0pt}Impl{\isachardot}{\kern0pt}fold\ {\isacharparenleft}{\kern0pt}add{\isacharunderscore}{\kern0pt}option{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}rbt\ f{\isacharparenright}{\kern0pt}\ t{\isadigit{1}}\ t{\isacharprime}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ Branch{\isacharparenleft}{\kern0pt}{\isadigit{3}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ intro{\isacharcolon}{\kern0pt}\ is{\isacharunderscore}{\kern0pt}rbt{\isacharunderscore}{\kern0pt}fold{\isacharunderscore}{\kern0pt}add{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}rbt{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}case\isanewline
\ \ \isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}cases\ {\isachardoublequoteopen}f\ k{\isachardoublequoteclose}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{case}\isamarkupfalse%
\ None\isanewline
\ \ \ \ \isacommand{have}\isamarkupfalse%
\ fold{\isacharunderscore}{\kern0pt}set{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}x\ {\isasymin}\ Option{\isachardot}{\kern0pt}these\ {\isacharparenleft}{\kern0pt}f\ {\isacharbackquote}{\kern0pt}\ set\ {\isacharparenleft}{\kern0pt}RBT{\isacharunderscore}{\kern0pt}Impl{\isachardot}{\kern0pt}keys\ t{\isadigit{2}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymunion}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}Option{\isachardot}{\kern0pt}these\ {\isacharparenleft}{\kern0pt}f\ {\isacharbackquote}{\kern0pt}\ set\ {\isacharparenleft}{\kern0pt}RBT{\isacharunderscore}{\kern0pt}Impl{\isachardot}{\kern0pt}keys\ t{\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymunion}\ set\ {\isacharparenleft}{\kern0pt}RBT{\isacharunderscore}{\kern0pt}Impl{\isachardot}{\kern0pt}keys\ t{\isacharprime}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymlongleftrightarrow}\isanewline
\ \ \ \ \ \ x\ {\isasymin}\ Option{\isachardot}{\kern0pt}these\ {\isacharparenleft}{\kern0pt}f\ {\isacharbackquote}{\kern0pt}\ set\ {\isacharparenleft}{\kern0pt}RBT{\isacharunderscore}{\kern0pt}Impl{\isachardot}{\kern0pt}keys\ {\isacharparenleft}{\kern0pt}Branch\ col\ t{\isadigit{1}}\ k\ v\ t{\isadigit{2}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymunion}\ set\ {\isacharparenleft}{\kern0pt}RBT{\isacharunderscore}{\kern0pt}Impl{\isachardot}{\kern0pt}keys\ t{\isacharprime}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp{\isacharcolon}{\kern0pt}\ None{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\isanewline
\ \ \ \ \ \ \isacommand{unfolding}\isamarkupfalse%
\ fold{\isacharunderscore}{\kern0pt}simps\ comp{\isacharunderscore}{\kern0pt}def\ None\ option{\isachardot}{\kern0pt}case{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ Branch{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}{\isacharbrackleft}{\kern0pt}OF\ valid{\isacharbrackright}{\kern0pt}\ keys{\isacharunderscore}{\kern0pt}add{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}rbt{\isacharbrackleft}{\kern0pt}OF\ valid{\isacharbrackright}{\kern0pt}\ keys{\isacharunderscore}{\kern0pt}fold{\isacharunderscore}{\kern0pt}add{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}rbt{\isacharbrackleft}{\kern0pt}OF\ Branch{\isacharparenleft}{\kern0pt}{\isadigit{3}}{\isacharparenright}{\kern0pt}{\isacharbrackright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ rbt{\isacharunderscore}{\kern0pt}lookup{\isacharunderscore}{\kern0pt}add{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}rbt{\isacharbrackleft}{\kern0pt}OF\ valid{\isacharbrackright}{\kern0pt}\ Branch{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharbrackleft}{\kern0pt}OF\ Branch{\isacharparenleft}{\kern0pt}{\isadigit{3}}{\isacharparenright}{\kern0pt}{\isacharbrackright}{\kern0pt}\ fold{\isacharunderscore}{\kern0pt}set\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ rbt{\isacharunderscore}{\kern0pt}lookup{\isacharunderscore}{\kern0pt}iff{\isacharunderscore}{\kern0pt}keys{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharcomma}{\kern0pt}{\isadigit{3}}{\isacharparenright}{\kern0pt}{\isacharbrackleft}{\kern0pt}OF\ is{\isacharunderscore}{\kern0pt}rbt{\isacharunderscore}{\kern0pt}rbt{\isacharunderscore}{\kern0pt}sorted{\isacharbrackleft}{\kern0pt}OF\ Branch{\isacharparenleft}{\kern0pt}{\isadigit{3}}{\isacharparenright}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isacharbrackright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp{\isacharcolon}{\kern0pt}\ None\ split{\isacharcolon}{\kern0pt}\ option{\isachardot}{\kern0pt}splits{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}auto\ dest{\isacharcolon}{\kern0pt}\ these{\isacharunderscore}{\kern0pt}imageI{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{next}\isamarkupfalse%
\isanewline
\ \ \ \ \isacommand{case}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}Some\ a{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{have}\isamarkupfalse%
\ valid{\isacharprime}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}is{\isacharunderscore}{\kern0pt}rbt\ {\isacharparenleft}{\kern0pt}add{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}rbt\ {\isacharparenleft}{\kern0pt}a{\isacharcomma}{\kern0pt}\ k{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}RBT{\isacharunderscore}{\kern0pt}Impl{\isachardot}{\kern0pt}fold\ {\isacharparenleft}{\kern0pt}add{\isacharunderscore}{\kern0pt}option{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}rbt\ f{\isacharparenright}{\kern0pt}\ t{\isadigit{1}}\ t{\isacharprime}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ intro{\isacharcolon}{\kern0pt}\ is{\isacharunderscore}{\kern0pt}rbt{\isacharunderscore}{\kern0pt}add{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}rbt{\isacharbrackleft}{\kern0pt}OF\ valid{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{have}\isamarkupfalse%
\ fold{\isacharunderscore}{\kern0pt}set{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}x\ {\isasymin}\ Option{\isachardot}{\kern0pt}these\ {\isacharparenleft}{\kern0pt}f\ {\isacharbackquote}{\kern0pt}\ set\ {\isacharparenleft}{\kern0pt}RBT{\isacharunderscore}{\kern0pt}Impl{\isachardot}{\kern0pt}keys\ t{\isadigit{2}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymunion}\ {\isacharparenleft}{\kern0pt}insert\ a\ {\isacharparenleft}{\kern0pt}Option{\isachardot}{\kern0pt}these\ {\isacharparenleft}{\kern0pt}f\ {\isacharbackquote}{\kern0pt}\ set\ {\isacharparenleft}{\kern0pt}RBT{\isacharunderscore}{\kern0pt}Impl{\isachardot}{\kern0pt}keys\ t{\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymunion}\ set\ {\isacharparenleft}{\kern0pt}RBT{\isacharunderscore}{\kern0pt}Impl{\isachardot}{\kern0pt}keys\ t{\isacharprime}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymlongleftrightarrow}\isanewline
\ \ \ \ x\ {\isasymin}\ Option{\isachardot}{\kern0pt}these\ {\isacharparenleft}{\kern0pt}f\ {\isacharbackquote}{\kern0pt}\ set\ {\isacharparenleft}{\kern0pt}RBT{\isacharunderscore}{\kern0pt}Impl{\isachardot}{\kern0pt}keys\ {\isacharparenleft}{\kern0pt}Branch\ col\ t{\isadigit{1}}\ k\ v\ t{\isadigit{2}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymunion}\ set\ {\isacharparenleft}{\kern0pt}RBT{\isacharunderscore}{\kern0pt}Impl{\isachardot}{\kern0pt}keys\ t{\isacharprime}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp{\isacharcolon}{\kern0pt}\ Some{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{have}\isamarkupfalse%
\ F{\isadigit{1}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}case\ if\ P\ then\ Some\ X\ else\ None\ of\ None\ {\isasymRightarrow}\ {\isacharbraceleft}{\kern0pt}k{\isacharbraceright}{\kern0pt}\ {\isacharbar}{\kern0pt}\ Some\ Y\ {\isasymRightarrow}\ insert\ k\ Y{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\isanewline
\ \ \ \ {\isacharparenleft}{\kern0pt}if\ P\ then\ {\isacharparenleft}{\kern0pt}insert\ k\ X{\isacharparenright}{\kern0pt}\ else\ {\isacharbraceleft}{\kern0pt}k{\isacharbraceright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isakeyword{for}\ P\ X\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \isacommand{have}\isamarkupfalse%
\ F{\isadigit{2}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}case\ if\ a\ {\isacharequal}{\kern0pt}\ x\ then\ Some\ X\ else\ if\ P\ then\ Some\ Y\ else\ None\ of\ None\ {\isasymRightarrow}\ {\isacharbraceleft}{\kern0pt}{\isacharbraceright}{\kern0pt}\ {\isacharbar}{\kern0pt}\ Some\ Y\ {\isasymRightarrow}\ Y{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\isanewline
\ \ \ \ {\isacharparenleft}{\kern0pt}if\ a\ {\isacharequal}{\kern0pt}\ x\ then\ X\ else\ if\ P\ then\ Y\ else\ {\isacharbraceleft}{\kern0pt}{\isacharbraceright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isakeyword{for}\ P\ X\ \isakeyword{and}\ Y\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharprime}{\kern0pt}b\ set{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\isanewline
\ \ \ \ \ \ \isacommand{unfolding}\isamarkupfalse%
\ fold{\isacharunderscore}{\kern0pt}simps\ comp{\isacharunderscore}{\kern0pt}def\ Some\ option{\isachardot}{\kern0pt}case{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\ Branch{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}{\isacharbrackleft}{\kern0pt}OF\ valid{\isacharprime}{\kern0pt}{\isacharbrackright}{\kern0pt}\ keys{\isacharunderscore}{\kern0pt}add{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}rbt{\isacharbrackleft}{\kern0pt}OF\ valid{\isacharbrackright}{\kern0pt}\ keys{\isacharunderscore}{\kern0pt}fold{\isacharunderscore}{\kern0pt}add{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}rbt{\isacharbrackleft}{\kern0pt}OF\ Branch{\isacharparenleft}{\kern0pt}{\isadigit{3}}{\isacharparenright}{\kern0pt}{\isacharbrackright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ rbt{\isacharunderscore}{\kern0pt}lookup{\isacharunderscore}{\kern0pt}add{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}rbt{\isacharbrackleft}{\kern0pt}OF\ valid{\isacharbrackright}{\kern0pt}\ Branch{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharbrackleft}{\kern0pt}OF\ Branch{\isacharparenleft}{\kern0pt}{\isadigit{3}}{\isacharparenright}{\kern0pt}{\isacharbrackright}{\kern0pt}\ fold{\isacharunderscore}{\kern0pt}set\ F{\isadigit{1}}\ F{\isadigit{2}}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ rbt{\isacharunderscore}{\kern0pt}lookup{\isacharunderscore}{\kern0pt}iff{\isacharunderscore}{\kern0pt}keys{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharcomma}{\kern0pt}{\isadigit{3}}{\isacharparenright}{\kern0pt}{\isacharbrackleft}{\kern0pt}OF\ is{\isacharunderscore}{\kern0pt}rbt{\isacharunderscore}{\kern0pt}rbt{\isacharunderscore}{\kern0pt}sorted{\isacharbrackleft}{\kern0pt}OF\ Branch{\isacharparenleft}{\kern0pt}{\isadigit{3}}{\isacharparenright}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isacharbrackright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp{\isacharcolon}{\kern0pt}\ Some\ split{\isacharcolon}{\kern0pt}\ option{\isachardot}{\kern0pt}splits{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}auto\ dest{\isacharcolon}{\kern0pt}\ these{\isacharunderscore}{\kern0pt}imageI{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{end}\isamarkupfalse%
\isanewline
\isanewline
\isacommand{context}\isamarkupfalse%
\isanewline
\ \ \isakeyword{fixes}\ c\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharprime}{\kern0pt}a\ comparator{\isachardoublequoteclose}\isanewline
\isakeyword{begin}\isanewline
\isanewline
\isacommand{definition}\isamarkupfalse%
\ add{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}rbt{\isacharunderscore}{\kern0pt}comp\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharprime}{\kern0pt}a\ {\isasymtimes}\ {\isacharprime}{\kern0pt}b\ {\isasymRightarrow}\ {\isacharparenleft}{\kern0pt}{\isacharprime}{\kern0pt}a{\isacharcomma}{\kern0pt}\ {\isacharprime}{\kern0pt}b\ set{\isacharparenright}{\kern0pt}\ rbt\ {\isasymRightarrow}\ {\isacharparenleft}{\kern0pt}{\isacharprime}{\kern0pt}a{\isacharcomma}{\kern0pt}\ {\isacharprime}{\kern0pt}b\ set{\isacharparenright}{\kern0pt}\ rbt{\isachardoublequoteclose}\ \isakeyword{where}\isanewline
\ \ {\isachardoublequoteopen}add{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}rbt{\isacharunderscore}{\kern0pt}comp\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}{\isacharparenleft}{\kern0pt}a{\isacharcomma}{\kern0pt}\ b{\isacharparenright}{\kern0pt}\ t{\isachardot}{\kern0pt}\ case\ rbt{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}lookup\ c\ t\ a\ of\ None\ {\isasymRightarrow}\ rbt{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}insert\ c\ a\ {\isacharbraceleft}{\kern0pt}b{\isacharbraceright}{\kern0pt}\ t\isanewline
\ \ {\isacharbar}{\kern0pt}\ Some\ X\ {\isasymRightarrow}\ rbt{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}insert\ c\ a\ {\isacharparenleft}{\kern0pt}insert\ b\ X{\isacharparenright}{\kern0pt}\ t{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{abbreviation}\isamarkupfalse%
\ {\isachardoublequoteopen}add{\isacharunderscore}{\kern0pt}option{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}rbt{\isacharunderscore}{\kern0pt}comp\ f\ {\isasymequiv}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}b\ {\isacharunderscore}{\kern0pt}\ t{\isachardot}{\kern0pt}\ case\ f\ b\ of\ Some\ a\ {\isasymRightarrow}\ add{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}rbt{\isacharunderscore}{\kern0pt}comp\ {\isacharparenleft}{\kern0pt}a{\isacharcomma}{\kern0pt}\ b{\isacharparenright}{\kern0pt}\ t\ {\isacharbar}{\kern0pt}\ None\ {\isasymRightarrow}\ t{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{definition}\isamarkupfalse%
\ cluster{\isacharunderscore}{\kern0pt}rbt{\isacharunderscore}{\kern0pt}comp\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isacharprime}{\kern0pt}b\ {\isasymRightarrow}\ {\isacharprime}{\kern0pt}a\ option{\isacharparenright}{\kern0pt}\ {\isasymRightarrow}\ {\isacharparenleft}{\kern0pt}{\isacharprime}{\kern0pt}b{\isacharcomma}{\kern0pt}\ unit{\isacharparenright}{\kern0pt}\ rbt\ {\isasymRightarrow}\ {\isacharparenleft}{\kern0pt}{\isacharprime}{\kern0pt}a{\isacharcomma}{\kern0pt}\ {\isacharprime}{\kern0pt}b\ set{\isacharparenright}{\kern0pt}\ rbt{\isachardoublequoteclose}\ \isakeyword{where}\isanewline
\ \ {\isachardoublequoteopen}cluster{\isacharunderscore}{\kern0pt}rbt{\isacharunderscore}{\kern0pt}comp\ f\ t\ {\isacharequal}{\kern0pt}\ RBT{\isacharunderscore}{\kern0pt}Impl{\isachardot}{\kern0pt}fold\ {\isacharparenleft}{\kern0pt}add{\isacharunderscore}{\kern0pt}option{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}rbt{\isacharunderscore}{\kern0pt}comp\ f{\isacharparenright}{\kern0pt}\ t\ RBT{\isacharunderscore}{\kern0pt}Impl{\isachardot}{\kern0pt}Empty{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{context}\isamarkupfalse%
\isanewline
\ \ \isakeyword{assumes}\ c{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}comparator\ c{\isachardoublequoteclose}\isanewline
\isakeyword{begin}\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ add{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}rbt{\isacharunderscore}{\kern0pt}comp{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}add{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}rbt{\isacharunderscore}{\kern0pt}comp\ {\isacharequal}{\kern0pt}\ ord{\isachardot}{\kern0pt}add{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}rbt\ {\isacharparenleft}{\kern0pt}lt{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}comp\ c{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{unfolding}\isamarkupfalse%
\ add{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}rbt{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}def\ ord{\isachardot}{\kern0pt}add{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}rbt{\isacharunderscore}{\kern0pt}def\ rbt{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}lookup{\isacharbrackleft}{\kern0pt}OF\ c{\isacharbrackright}{\kern0pt}\ rbt{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}insert{\isacharbrackleft}{\kern0pt}OF\ c{\isacharbrackright}{\kern0pt}\isanewline
\ \ \isacommand{by}\isamarkupfalse%
\ simp%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ cluster{\isacharunderscore}{\kern0pt}rbt{\isacharunderscore}{\kern0pt}comp{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}cluster{\isacharunderscore}{\kern0pt}rbt{\isacharunderscore}{\kern0pt}comp\ {\isacharequal}{\kern0pt}\ ord{\isachardot}{\kern0pt}cluster{\isacharunderscore}{\kern0pt}rbt\ {\isacharparenleft}{\kern0pt}lt{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}comp\ c{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{unfolding}\isamarkupfalse%
\ cluster{\isacharunderscore}{\kern0pt}rbt{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}def\ ord{\isachardot}{\kern0pt}cluster{\isacharunderscore}{\kern0pt}rbt{\isacharunderscore}{\kern0pt}def\ add{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}rbt{\isacharunderscore}{\kern0pt}comp\isanewline
\ \ \isacommand{by}\isamarkupfalse%
\ simp%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{end}\isamarkupfalse%
\isanewline
\isanewline
\isacommand{end}\isamarkupfalse%
\isanewline
\isanewline
\isacommand{lift{\isacharunderscore}{\kern0pt}definition}\isamarkupfalse%
\ mapping{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}cluster\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isacharprime}{\kern0pt}b\ {\isasymRightarrow}\ {\isacharprime}{\kern0pt}a\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ ccompare\ option{\isacharparenright}{\kern0pt}\ {\isasymRightarrow}\ {\isacharparenleft}{\kern0pt}{\isacharprime}{\kern0pt}b{\isacharcomma}{\kern0pt}\ unit{\isacharparenright}{\kern0pt}\ rbt\ {\isasymRightarrow}\ {\isacharparenleft}{\kern0pt}{\isacharprime}{\kern0pt}a{\isacharcomma}{\kern0pt}\ {\isacharprime}{\kern0pt}b\ set{\isacharparenright}{\kern0pt}\ mapping{\isacharunderscore}{\kern0pt}rbt{\isachardoublequoteclose}\ \isakeyword{is}\isanewline
\ \ {\isachardoublequoteopen}cluster{\isacharunderscore}{\kern0pt}rbt{\isacharunderscore}{\kern0pt}comp\ ccomp{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ linorder{\isachardot}{\kern0pt}is{\isacharunderscore}{\kern0pt}rbt{\isacharunderscore}{\kern0pt}fold{\isacharunderscore}{\kern0pt}add{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}rbt{\isacharbrackleft}{\kern0pt}OF\ comparator{\isachardot}{\kern0pt}linorder{\isacharbrackleft}{\kern0pt}OF\ ID{\isacharunderscore}{\kern0pt}ccompare{\isacharprime}{\kern0pt}{\isacharbrackright}{\kern0pt}\ ord{\isachardot}{\kern0pt}Empty{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}rbt{\isacharbrackright}{\kern0pt}\isanewline
\ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}fastforce\ simp{\isacharcolon}{\kern0pt}\ cluster{\isacharunderscore}{\kern0pt}rbt{\isacharunderscore}{\kern0pt}comp{\isacharbrackleft}{\kern0pt}OF\ ID{\isacharunderscore}{\kern0pt}ccompare{\isacharprime}{\kern0pt}{\isacharbrackright}{\kern0pt}\ ord{\isachardot}{\kern0pt}cluster{\isacharunderscore}{\kern0pt}rbt{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ cluster{\isacharunderscore}{\kern0pt}code{\isacharbrackleft}{\kern0pt}code{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{fixes}\ f\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharprime}{\kern0pt}b\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ ccompare\ {\isasymRightarrow}\ {\isacharprime}{\kern0pt}a\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ ccompare\ option{\isachardoublequoteclose}\ \isakeyword{and}\ t\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isacharprime}{\kern0pt}b{\isacharcomma}{\kern0pt}\ unit{\isacharparenright}{\kern0pt}\ mapping{\isacharunderscore}{\kern0pt}rbt{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}cluster\ f\ {\isacharparenleft}{\kern0pt}RBT{\isacharunderscore}{\kern0pt}set\ t{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}case\ ID\ CCOMPARE{\isacharparenleft}{\kern0pt}{\isacharprime}{\kern0pt}a{\isacharparenright}{\kern0pt}\ of\ None\ {\isasymRightarrow}\isanewline
\ \ \ \ Code{\isachardot}{\kern0pt}abort\ {\isacharparenleft}{\kern0pt}STR\ {\isacharprime}{\kern0pt}{\isacharprime}{\kern0pt}cluster{\isacharcolon}{\kern0pt}\ ccompare\ {\isacharequal}{\kern0pt}\ None{\isacharprime}{\kern0pt}{\isacharprime}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}{\isacharunderscore}{\kern0pt}{\isachardot}{\kern0pt}\ cluster\ f\ {\isacharparenleft}{\kern0pt}RBT{\isacharunderscore}{\kern0pt}set\ t{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ {\isacharbar}{\kern0pt}\ Some\ c\ {\isasymRightarrow}\ {\isacharparenleft}{\kern0pt}case\ ID\ CCOMPARE{\isacharparenleft}{\kern0pt}{\isacharprime}{\kern0pt}b{\isacharparenright}{\kern0pt}\ of\ None\ {\isasymRightarrow}\isanewline
\ \ \ \ Code{\isachardot}{\kern0pt}abort\ {\isacharparenleft}{\kern0pt}STR\ {\isacharprime}{\kern0pt}{\isacharprime}{\kern0pt}cluster{\isacharcolon}{\kern0pt}\ ccompare\ {\isacharequal}{\kern0pt}\ None{\isacharprime}{\kern0pt}{\isacharprime}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}{\isacharunderscore}{\kern0pt}{\isachardot}{\kern0pt}\ cluster\ f\ {\isacharparenleft}{\kern0pt}RBT{\isacharunderscore}{\kern0pt}set\ t{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ {\isacharbar}{\kern0pt}\ Some\ c{\isacharprime}{\kern0pt}\ {\isasymRightarrow}\ {\isacharparenleft}{\kern0pt}RBT{\isacharunderscore}{\kern0pt}Mapping\ {\isacharparenleft}{\kern0pt}mapping{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}cluster\ f\ {\isacharparenleft}{\kern0pt}RBT{\isacharunderscore}{\kern0pt}Mapping{\isadigit{2}}{\isachardot}{\kern0pt}impl{\isacharunderscore}{\kern0pt}of\ t{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\isanewline
\ \ \isacommand{{\isacharbraceleft}{\kern0pt}}\isamarkupfalse%
\isanewline
\ \ \ \ \isacommand{fix}\isamarkupfalse%
\ c\ c{\isacharprime}{\kern0pt}\isanewline
\ \ \ \ \isacommand{assume}\isamarkupfalse%
\ assms{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}ID\ ccompare\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}Some\ c\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isacharprime}{\kern0pt}a\ comparator\ option{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ {\isachardoublequoteopen}ID\ ccompare\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}Some\ c{\isacharprime}{\kern0pt}\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isacharprime}{\kern0pt}b\ comparator\ option{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{have}\isamarkupfalse%
\ c{\isacharunderscore}{\kern0pt}def{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}c\ {\isacharequal}{\kern0pt}\ ccomp{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \isacommand{have}\isamarkupfalse%
\ c{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}def{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}c{\isacharprime}{\kern0pt}\ {\isacharequal}{\kern0pt}\ ccomp{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \isacommand{have}\isamarkupfalse%
\ c{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}comparator\ {\isacharparenleft}{\kern0pt}ccomp\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isacharprime}{\kern0pt}a\ comparator{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ ID{\isacharunderscore}{\kern0pt}ccompare{\isacharprime}{\kern0pt}{\isacharbrackleft}{\kern0pt}OF\ assms{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharbrackright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp{\isacharcolon}{\kern0pt}\ c{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{have}\isamarkupfalse%
\ c{\isacharprime}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}comparator\ {\isacharparenleft}{\kern0pt}ccomp\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isacharprime}{\kern0pt}b\ comparator{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ ID{\isacharunderscore}{\kern0pt}ccompare{\isacharprime}{\kern0pt}{\isacharbrackleft}{\kern0pt}OF\ assms{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}{\isacharbrackright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp{\isacharcolon}{\kern0pt}\ c{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{note}\isamarkupfalse%
\ c{\isacharunderscore}{\kern0pt}class\ {\isacharequal}{\kern0pt}\ comparator{\isachardot}{\kern0pt}linorder{\isacharbrackleft}{\kern0pt}OF\ c{\isacharbrackright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{note}\isamarkupfalse%
\ c{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}class\ {\isacharequal}{\kern0pt}\ comparator{\isachardot}{\kern0pt}linorder{\isacharbrackleft}{\kern0pt}OF\ c{\isacharprime}{\kern0pt}{\isacharbrackright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{have}\isamarkupfalse%
\ rbt{\isacharunderscore}{\kern0pt}lookup{\isacharunderscore}{\kern0pt}cluster{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}ord{\isachardot}{\kern0pt}rbt{\isacharunderscore}{\kern0pt}lookup\ cless\ {\isacharparenleft}{\kern0pt}cluster{\isacharunderscore}{\kern0pt}rbt{\isacharunderscore}{\kern0pt}comp\ ccomp\ f\ t{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\isanewline
\ \ \ \ \ \ {\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ if\ x\ {\isasymin}\ Option{\isachardot}{\kern0pt}these\ {\isacharparenleft}{\kern0pt}f\ {\isacharbackquote}{\kern0pt}\ {\isacharparenleft}{\kern0pt}set\ {\isacharparenleft}{\kern0pt}RBT{\isacharunderscore}{\kern0pt}Impl{\isachardot}{\kern0pt}keys\ t{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ then\ Some\ {\isacharbraceleft}{\kern0pt}y\ {\isasymin}\ {\isacharparenleft}{\kern0pt}set\ {\isacharparenleft}{\kern0pt}RBT{\isacharunderscore}{\kern0pt}Impl{\isachardot}{\kern0pt}keys\ t{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardot}{\kern0pt}\ f\ y\ {\isacharequal}{\kern0pt}\ Some\ x{\isacharbraceright}{\kern0pt}\ else\ None{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isakeyword{if}\ {\isachardoublequoteopen}ord{\isachardot}{\kern0pt}is{\isacharunderscore}{\kern0pt}rbt\ cless\ {\isacharparenleft}{\kern0pt}t\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharprime}{\kern0pt}b{\isacharcomma}{\kern0pt}\ unit{\isacharparenright}{\kern0pt}\ rbt{\isacharparenright}{\kern0pt}\ {\isasymor}\ ID\ ccompare\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}None\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isacharprime}{\kern0pt}b\ comparator\ option{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isakeyword{for}\ t\isanewline
\ \ \ \ \isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ is{\isacharunderscore}{\kern0pt}rbt{\isacharunderscore}{\kern0pt}t{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}ord{\isachardot}{\kern0pt}is{\isacharunderscore}{\kern0pt}rbt\ cless\ t{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ that\isanewline
\ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \ \ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\isanewline
\ \ \ \ \ \ \ \ \isacommand{unfolding}\isamarkupfalse%
\ cluster{\isacharunderscore}{\kern0pt}rbt{\isacharunderscore}{\kern0pt}comp{\isacharbrackleft}{\kern0pt}OF\ c{\isacharbrackright}{\kern0pt}\ ord{\isachardot}{\kern0pt}cluster{\isacharunderscore}{\kern0pt}rbt{\isacharunderscore}{\kern0pt}def\ linorder{\isachardot}{\kern0pt}rbt{\isacharunderscore}{\kern0pt}lookup{\isacharunderscore}{\kern0pt}fold{\isacharunderscore}{\kern0pt}add{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}rbt{\isacharbrackleft}{\kern0pt}OF\ c{\isacharunderscore}{\kern0pt}class\ ord{\isachardot}{\kern0pt}Empty{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}rbt{\isacharbrackright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp{\isacharcolon}{\kern0pt}\ ord{\isachardot}{\kern0pt}rbt{\isacharunderscore}{\kern0pt}lookup{\isachardot}{\kern0pt}simps\ split{\isacharcolon}{\kern0pt}\ option{\isachardot}{\kern0pt}splits{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \ \ \isacommand{have}\isamarkupfalse%
\ dom{\isacharunderscore}{\kern0pt}ord{\isacharunderscore}{\kern0pt}rbt{\isacharunderscore}{\kern0pt}lookup{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}ord{\isachardot}{\kern0pt}is{\isacharunderscore}{\kern0pt}rbt\ cless\ t\ {\isasymLongrightarrow}\ dom\ {\isacharparenleft}{\kern0pt}ord{\isachardot}{\kern0pt}rbt{\isacharunderscore}{\kern0pt}lookup\ cless\ t{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ set\ {\isacharparenleft}{\kern0pt}RBT{\isacharunderscore}{\kern0pt}Impl{\isachardot}{\kern0pt}keys\ t{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isakeyword{for}\ t\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isacharprime}{\kern0pt}b{\isacharcomma}{\kern0pt}\ unit{\isacharparenright}{\kern0pt}\ rbt{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ linorder{\isachardot}{\kern0pt}rbt{\isacharunderscore}{\kern0pt}lookup{\isacharunderscore}{\kern0pt}keys{\isacharbrackleft}{\kern0pt}OF\ c{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}class{\isacharbrackright}{\kern0pt}\ ord{\isachardot}{\kern0pt}is{\isacharunderscore}{\kern0pt}rbt{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}cluster\ f\ {\isacharparenleft}{\kern0pt}Collect\ {\isacharparenleft}{\kern0pt}RBT{\isacharunderscore}{\kern0pt}Set{\isadigit{2}}{\isachardot}{\kern0pt}member\ t{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ Mapping\ {\isacharparenleft}{\kern0pt}RBT{\isacharunderscore}{\kern0pt}Mapping{\isadigit{2}}{\isachardot}{\kern0pt}lookup\ {\isacharparenleft}{\kern0pt}mapping{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}cluster\ f\ {\isacharparenleft}{\kern0pt}mapping{\isacharunderscore}{\kern0pt}rbt{\isachardot}{\kern0pt}impl{\isacharunderscore}{\kern0pt}of\ t{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}{\isacharbrackleft}{\kern0pt}unfolded\ c{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}def{\isacharbrackright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}transfer\ fixing{\isacharcolon}{\kern0pt}\ f{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}auto\ simp{\isacharcolon}{\kern0pt}\ in{\isacharunderscore}{\kern0pt}these{\isacharunderscore}{\kern0pt}eq\ rbt{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}lookup{\isacharbrackleft}{\kern0pt}OF\ c{\isacharbrackright}{\kern0pt}\ rbt{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}lookup{\isacharbrackleft}{\kern0pt}OF\ c{\isacharprime}{\kern0pt}{\isacharbrackright}{\kern0pt}\ rbt{\isacharunderscore}{\kern0pt}lookup{\isacharunderscore}{\kern0pt}cluster\ dom{\isacharunderscore}{\kern0pt}ord{\isacharunderscore}{\kern0pt}rbt{\isacharunderscore}{\kern0pt}lookup{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{{\isacharbraceright}{\kern0pt}}\isamarkupfalse%
\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\isanewline
\ \ \ \ \isacommand{unfolding}\isamarkupfalse%
\ RBT{\isacharunderscore}{\kern0pt}set{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ split{\isacharcolon}{\kern0pt}\ option{\isachardot}{\kern0pt}splits{\isacharparenright}{\kern0pt}\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
%
\isadelimtheory
\isanewline
%
\endisadelimtheory
%
\isatagtheory
\isacommand{end}\isamarkupfalse%
%
\endisatagtheory
{\isafoldtheory}%
%
\isadelimtheory
%
\endisadelimtheory
%
\end{isabellebody}%
\endinput
%:%file=~/phd/rewriting/ailamazyan/thys/Cluster.thy%:%
%:%10=1%:%
%:%11=1%:%
%:%12=2%:%
%:%13=3%:%
%:%18=3%:%
%:%21=4%:%
%:%22=5%:%
%:%23=5%:%
%:%26=6%:%
%:%30=6%:%
%:%31=6%:%
%:%36=6%:%
%:%39=7%:%
%:%40=8%:%
%:%41=8%:%
%:%44=9%:%
%:%48=9%:%
%:%49=9%:%
%:%54=9%:%
%:%57=10%:%
%:%58=11%:%
%:%59=11%:%
%:%62=12%:%
%:%66=12%:%
%:%67=12%:%
%:%72=12%:%
%:%75=13%:%
%:%76=14%:%
%:%77=14%:%
%:%80=15%:%
%:%84=15%:%
%:%85=15%:%
%:%90=15%:%
%:%93=16%:%
%:%94=17%:%
%:%95=17%:%
%:%96=18%:%
%:%98=18%:%
%:%102=18%:%
%:%110=18%:%
%:%111=19%:%
%:%112=20%:%
%:%113=20%:%
%:%116=21%:%
%:%120=21%:%
%:%121=21%:%
%:%126=21%:%
%:%129=22%:%
%:%130=23%:%
%:%131=23%:%
%:%134=24%:%
%:%138=24%:%
%:%139=24%:%
%:%144=24%:%
%:%147=25%:%
%:%148=26%:%
%:%149=26%:%
%:%150=27%:%
%:%151=28%:%
%:%152=29%:%
%:%153=29%:%
%:%154=30%:%
%:%155=31%:%
%:%156=32%:%
%:%157=32%:%
%:%158=33%:%
%:%159=34%:%
%:%160=34%:%
%:%161=35%:%
%:%162=36%:%
%:%163=37%:%
%:%164=37%:%
%:%165=38%:%
%:%166=39%:%
%:%167=39%:%
%:%168=40%:%
%:%169=41%:%
%:%170=42%:%
%:%171=42%:%
%:%174=43%:%
%:%178=43%:%
%:%179=43%:%
%:%184=43%:%
%:%187=44%:%
%:%188=45%:%
%:%189=45%:%
%:%190=46%:%
%:%193=47%:%
%:%197=47%:%
%:%198=47%:%
%:%203=47%:%
%:%206=48%:%
%:%207=49%:%
%:%208=49%:%
%:%211=50%:%
%:%215=50%:%
%:%216=50%:%
%:%217=51%:%
%:%218=51%:%
%:%223=51%:%
%:%226=52%:%
%:%227=53%:%
%:%228=53%:%
%:%229=54%:%
%:%232=55%:%
%:%236=55%:%
%:%237=55%:%
%:%242=55%:%
%:%245=56%:%
%:%246=57%:%
%:%247=57%:%
%:%248=58%:%
%:%251=59%:%
%:%255=59%:%
%:%256=59%:%
%:%261=59%:%
%:%264=60%:%
%:%265=61%:%
%:%266=61%:%
%:%269=62%:%
%:%273=62%:%
%:%274=62%:%
%:%279=62%:%
%:%282=63%:%
%:%283=64%:%
%:%284=64%:%
%:%285=65%:%
%:%292=66%:%
%:%293=66%:%
%:%294=67%:%
%:%295=67%:%
%:%296=68%:%
%:%297=68%:%
%:%298=69%:%
%:%299=69%:%
%:%300=70%:%
%:%301=70%:%
%:%302=71%:%
%:%303=71%:%
%:%304=72%:%
%:%305=72%:%
%:%306=73%:%
%:%307=73%:%
%:%308=74%:%
%:%309=74%:%
%:%310=75%:%
%:%311=75%:%
%:%312=76%:%
%:%313=76%:%
%:%314=77%:%
%:%315=77%:%
%:%316=78%:%
%:%317=78%:%
%:%318=79%:%
%:%319=79%:%
%:%320=80%:%
%:%321=80%:%
%:%322=81%:%
%:%323=81%:%
%:%324=82%:%
%:%325=82%:%
%:%326=83%:%
%:%327=83%:%
%:%332=83%:%
%:%335=84%:%
%:%336=85%:%
%:%337=85%:%
%:%340=86%:%
%:%344=86%:%
%:%345=86%:%
%:%350=86%:%
%:%353=87%:%
%:%354=88%:%
%:%355=88%:%
%:%357=90%:%
%:%364=91%:%
%:%365=91%:%
%:%366=92%:%
%:%367=92%:%
%:%368=93%:%
%:%369=93%:%
%:%370=93%:%
%:%371=94%:%
%:%372=94%:%
%:%373=95%:%
%:%374=95%:%
%:%375=96%:%
%:%376=96%:%
%:%377=97%:%
%:%378=97%:%
%:%379=98%:%
%:%380=98%:%
%:%381=99%:%
%:%382=99%:%
%:%383=100%:%
%:%384=100%:%
%:%385=101%:%
%:%386=101%:%
%:%387=102%:%
%:%388=102%:%
%:%389=103%:%
%:%390=103%:%
%:%391=104%:%
%:%392=104%:%
%:%393=105%:%
%:%394=106%:%
%:%395=106%:%
%:%396=107%:%
%:%397=107%:%
%:%398=108%:%
%:%399=108%:%
%:%400=109%:%
%:%401=110%:%
%:%402=110%:%
%:%403=111%:%
%:%404=111%:%
%:%405=112%:%
%:%406=112%:%
%:%407=113%:%
%:%408=113%:%
%:%409=114%:%
%:%410=114%:%
%:%411=115%:%
%:%412=115%:%
%:%413=116%:%
%:%414=116%:%
%:%415=117%:%
%:%416=118%:%
%:%417=118%:%
%:%418=119%:%
%:%419=119%:%
%:%420=120%:%
%:%421=121%:%
%:%422=121%:%
%:%423=122%:%
%:%424=122%:%
%:%425=123%:%
%:%426=124%:%
%:%427=125%:%
%:%428=125%:%
%:%429=126%:%
%:%430=126%:%
%:%431=127%:%
%:%432=127%:%
%:%433=128%:%
%:%434=129%:%
%:%435=129%:%
%:%436=130%:%
%:%437=130%:%
%:%438=131%:%
%:%439=131%:%
%:%440=132%:%
%:%446=132%:%
%:%449=133%:%
%:%450=134%:%
%:%451=134%:%
%:%452=135%:%
%:%453=136%:%
%:%454=136%:%
%:%455=137%:%
%:%456=138%:%
%:%457=139%:%
%:%458=140%:%
%:%459=140%:%
%:%460=141%:%
%:%461=142%:%
%:%462=143%:%
%:%463=144%:%
%:%464=144%:%
%:%465=145%:%
%:%466=146%:%
%:%467=146%:%
%:%468=147%:%
%:%469=148%:%
%:%470=149%:%
%:%471=149%:%
%:%472=150%:%
%:%473=151%:%
%:%474=152%:%
%:%475=153%:%
%:%476=153%:%
%:%479=154%:%
%:%483=154%:%
%:%484=154%:%
%:%485=155%:%
%:%486=155%:%
%:%491=155%:%
%:%494=156%:%
%:%495=157%:%
%:%496=157%:%
%:%499=158%:%
%:%503=158%:%
%:%504=158%:%
%:%505=159%:%
%:%506=159%:%
%:%511=159%:%
%:%514=160%:%
%:%515=161%:%
%:%516=161%:%
%:%517=162%:%
%:%518=163%:%
%:%519=163%:%
%:%520=164%:%
%:%521=165%:%
%:%522=165%:%
%:%523=166%:%
%:%526=167%:%
%:%530=167%:%
%:%531=167%:%
%:%532=168%:%
%:%533=168%:%
%:%538=168%:%
%:%541=169%:%
%:%542=170%:%
%:%543=170%:%
%:%544=171%:%
%:%545=172%:%
%:%549=176%:%
%:%556=177%:%
%:%557=177%:%
%:%558=178%:%
%:%559=178%:%
%:%560=179%:%
%:%561=179%:%
%:%562=180%:%
%:%563=180%:%
%:%564=181%:%
%:%565=181%:%
%:%566=182%:%
%:%567=182%:%
%:%568=183%:%
%:%569=183%:%
%:%570=184%:%
%:%571=184%:%
%:%572=185%:%
%:%573=185%:%
%:%574=186%:%
%:%575=186%:%
%:%576=187%:%
%:%577=187%:%
%:%578=188%:%
%:%579=188%:%
%:%580=189%:%
%:%581=189%:%
%:%582=190%:%
%:%583=190%:%
%:%584=191%:%
%:%585=191%:%
%:%586=192%:%
%:%587=192%:%
%:%588=193%:%
%:%589=193%:%
%:%590=194%:%
%:%591=194%:%
%:%592=195%:%
%:%593=195%:%
%:%594=196%:%
%:%595=197%:%
%:%596=198%:%
%:%597=198%:%
%:%598=199%:%
%:%599=199%:%
%:%600=200%:%
%:%601=200%:%
%:%602=201%:%
%:%603=201%:%
%:%604=202%:%
%:%605=202%:%
%:%606=203%:%
%:%607=203%:%
%:%608=204%:%
%:%609=204%:%
%:%610=205%:%
%:%611=205%:%
%:%612=206%:%
%:%613=206%:%
%:%614=207%:%
%:%615=207%:%
%:%616=208%:%
%:%617=208%:%
%:%618=209%:%
%:%619=209%:%
%:%620=210%:%
%:%621=210%:%
%:%622=211%:%
%:%623=211%:%
%:%624=212%:%
%:%625=212%:%
%:%626=213%:%
%:%627=213%:%
%:%628=213%:%
%:%629=214%:%
%:%630=214%:%
%:%631=215%:%
%:%632=215%:%
%:%633=216%:%
%:%639=216%:%
%:%644=217%:%
%:%649=218%:%